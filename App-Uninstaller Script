# App Uninstaller Script
# Prompts user to select an app to uninstall using Winget

Write-Host "Fetching installed apps..." -ForegroundColor Cyan

if (Get-Command winget -ErrorAction SilentlyContinue) {
    $apps = winget list | Out-String
    $apps | Out-File "$env:TEMP\\InstalledApps.txt"
    notepad "$env:TEMP\\InstalledApps.txt"

    $appName = Read-Host "Enter the name (or part of the name) of the app you want to uninstall"

    if ($appName) {
        winget uninstall --name "$appName"
        Write-Host "Attempted to uninstall $appName" -ForegroundColor Green
    } else {
        Write-Host "No app name entered. Exiting..." -ForegroundColor Yellow
    }
} else {
    Write-Host "`n⚠️ Winget is not available on this system. Please install it from the Microsoft Store (App Installer)." -ForegroundColor Red
}
